<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=EUC-JP">
<title>Module ocean_tracer_util_mod</title>
<link type="text/css" href="http://data1.gfdl.noaa.gov/~fms/style/docbook.css" rel="stylesheet">
<STYLE TYPE="text/css">
          .fixed {
            font-size:medium;
            font-family:monospace;
            border-style:none;
            border-width:0.1em;
            padding:0.1em;
            color:#663366;
          }
        </STYLE>
</head>
<body>
<a name="TOP"></a><font class="header" size="1"><a href="#PUBLIC INTERFACE">PUBLIC INTERFACE </a>

          ~ <a href="#PUBLIC ROUTINES">PUBLIC ROUTINES </a>
	    ~ <a href="#NAMELIST">NAMELIST </a></font>
<hr>
<h2>Module ocean_tracer_util_mod</h2>
<a name="HEADER"></a>
<!-- BEGIN HEADER -->
<div>
<b>Contact:&nbsp;</b><a href="mailto:GFDL.Climate.Model.Info@noaa.gov">
 S. M. Griffies 
 </a>
<br>
<b>Reviewers:&nbsp;</b>
<br>
<b>Change History:&nbsp;</b><a href="http://cobweb.gfdl.noaa.gov/fms-cgi-bin/viewcvs/FMS/ocean/mom5/ocean_diag">WebCVS Log</a>
<br>
<br>
</div>
<!-- END HEADER -->
<a name="OVERVIEW"></a>
<hr>
<h4>OVERVIEW</h4>
<!-- BEGIN OVERVIEW -->
<p class="text">
 This module contains many routines of use for tracer diagnostics in MOM. 
</p>
<!-- END OVERVIEW -->
<a name="DESCRIPTION"></a>
<!-- BEGIN DESCRIPTION -->
<div>
 Tracer utility module for MOM. Of use for tracer diagnostics. 
</div>
<br>
<!-- END DESCRIPTION -->
<a name="OTHER MODULES USED"></a>
<hr>
<h4>OTHER MODULES USED</h4>
<!-- BEGIN OTHER MODULES USED -->
<div>
<pre>       constants_mod<br>             fms_mod<br>             mpp_mod<br>        platform_mod<br>   ocean_domains_mod<br>ocean_parameters_mod<br>     ocean_types_mod<br>      ocean_util_mod<br> ocean_workspace_mod</pre>
</div>
<!-- END OTHER MODULES USED -->
<!-- BEGIN PUBLIC INTERFACE -->
<a name="PUBLIC INTERFACE"></a>
<hr>
<h4>PUBLIC INTERFACE</h4>
<div>
<dl>
<dt>
<a href="#ocean_tracer_util_init">ocean_tracer_util_init</a>:</dt>
<dd></dd>
<dt>
<a href="#tracer_min_max">tracer_min_max</a>:</dt>
<dd></dd>
<dt>
<a href="#dzt_min_max">dzt_min_max</a>:</dt>
<dd></dd>
<dt>
<a href="#tracer_prog_chksum">tracer_prog_chksum</a>:</dt>
<dd></dd>
<dt>
<a href="#tracer_diag_chksum">tracer_diag_chksum</a>:</dt>
<dd></dd>
<dt>
<a href="#tracer_psom_chksum">tracer_psom_chksum</a>:</dt>
<dd></dd>
<dt>
<a href="#sort_pick_array">sort_pick_array</a>:</dt>
<dd></dd>
<dt>
<a href="#sort_shell_array">sort_shell_array</a>:</dt>
<dd></dd>
<dt>
<a href="#rebin_onto_rho">rebin_onto_rho</a>:</dt>
<dd></dd>
<dt>
<a href="#diagnose_mass_of_layer_orig">diagnose_mass_of_layer_orig</a>:</dt>
<dd></dd>
<dt>
<a href="#diagnose_mass_of_layer">diagnose_mass_of_layer</a>:</dt>
<dd></dd>
</dl>
</div>
<br>
<!-- END PUBLIC INTERFACE -->
<a name="PUBLIC ROUTINES"></a>
<hr>
<h4>PUBLIC ROUTINES</h4>
<!-- BEGIN PUBLIC ROUTINES -->
<ol type="a">
<li>
<a name="ocean_tracer_util_init"></a>
<h4>ocean_tracer_util_init</h4>
<dl>
<dt>
<b>DESCRIPTION</b>
</dt>
<dd>
 Initialize MOM tracer utilities.
 </dd>
<br>
<br>
</dl>
</li>
<li>
<a name="tracer_min_max"></a>
<h4>tracer_min_max</h4>
<dl>
<dt>
<b>DESCRIPTION</b>
</dt>
<dd>
 Compute the global min and max for tracers.  

 Vectorized using maxloc() and minloc() intrinsic functions by 
 Russell.Fiedler@csiro.au (May 2005).

 Modified by Zhi.Liang (July 2005)
          
 </dd>
<br>
<br>
</dl>
</li>
<li>
<a name="dzt_min_max"></a>
<h4>dzt_min_max</h4>
<dl>
<dt>
<b>DESCRIPTION</b>
</dt>
<dd>
 Compute the global min and max for dzt.  

 Modified by Stephen.Griffies from subroutine tracer_min_max
          
 </dd>
<br>
<br>
</dl>
</li>
<li>
<a name="tracer_prog_chksum"></a>
<h4>tracer_prog_chksum</h4>
<dl>
<dt>
<b>DESCRIPTION</b>
</dt>
<dd>
 Compute checksums for prognostic tracers 
 </dd>
<br>
<br>
</dl>
</li>
<li>
<a name="tracer_diag_chksum"></a>
<h4>tracer_diag_chksum</h4>
<dl>
<dt>
<b>DESCRIPTION</b>
</dt>
<dd>
 Compute checksums for diagnostic tracers 
 </dd>
<br>
<br>
</dl>
</li>
<li>
<a name="tracer_psom_chksum"></a>
<h4>tracer_psom_chksum</h4>
<dl>
<dt>
<b>DESCRIPTION</b>
</dt>
<dd>
 Compute checksums for PSOM advection second order moments. 
 </dd>
<br>
<br>
</dl>
</li>
<li>
<a name="sort_pick_array"></a>
<h4>sort_pick_array</h4>
<dl>
<dt>
<b>DESCRIPTION</b>
</dt>
<dd>
 Simplest, and slowest, sorting algorithm from Numerical Recipes.
 Called "sort_pick" in Numerical Recipes.  

 Input are two arrays, first array defines the ascending sort 
 and second is a slave to the sort. 

 Typical example is sorting a vector of water parcels lightest
 to densest, with slave being volume of the parcels.  

 More sophisticated sorting algorithms exist, and may need to 
 be coded should this method prove too slow. 

 This scheme has order N^2 operations, which is a lot. 

 output has array(1) smallest and a(nsortpts) largest 
 with corresponding slave array.  

 coded Stephen.Griffies June 2005

 </dd>
<br>
<br>
</dl>
</li>
<li>
<a name="sort_shell_array"></a>
<h4>sort_shell_array</h4>
<dl>
<dt>
<b>DESCRIPTION</b>
</dt>
<dd>
 Shell (or diminishing increment) sort from Numerical Recipes.
 Called "sort_shell" in Numerical Recipes.  

 Input are two arrays, first array defines the ascending sort 
 and second is a slave to the sort array. 

 Typical example is sorting a vector of water parcels lightest  
 to densest, with slave being volume of the parcels.  

 More sophisticated sorting algorithms exist, and may need to 
 be coded should this method prove too slow. 

 This scheme has order N^(5/4) operations. 

 output has array(1) smallest and a(nsortpts) largest,
 with corresponding ordering for slave array.  

 coded Stephen.Griffies June 2005

 </dd>
<br>
<br>
</dl>
</li>
<li>
<a name="rebin_onto_rho"></a>
<h4>rebin_onto_rho</h4>
<dl>
<dt>
<b>DESCRIPTION</b>
</dt>
<dd>
 Bin a level input tendency field according to density classes. 
 The binning is meant for tendencies and transports, as used in particular
 for the neut_rho, wdian_rho, and tform_rho diagnostics.  

 Note that if use rebin_onto_rho_all_values=.false. then will 
 not be consistent with transport_on_nrho calculation, which includes
 bins all grid cells, including those outside of range for the bounds.  

 Stephen.Griffies 
 April 2012: algorithm made identical to transport_on_nrho as 
 computed in ocean_adv_vel_diag.

 </dd>
<br>
<br>
</dl>
</li>
<li>
<a name="diagnose_mass_of_layer_orig"></a>
<h4>diagnose_mass_of_layer_orig</h4>
<dl>
<dt>
<b>DESCRIPTION</b>
</dt>
<dd>

 Diagnose the mass of a layer as a function of layer and (i,j). 

 Method uses linear interpolation to find the mass per area of
 layer boundaries, which are then used to get mass per area of
 layer, and then mass through multipication by area.  

 Scheme currently does not forward (backwards) interpolate if 
 layer boundary lies within lowest (uppermost) grid cell.

 Diagnostic only makes sense when layer_level is monotonically
 increasing as go deeper in water column. 

 layer_bounds = neutral density of layer interfaces 
 mass_level   = mass per area at bottom of tracer cell
 layer_level  = neutral density of model grid levels   
 mass_layer   = diagnosed mass of a neutral density layer

 </dd>
<br>
<br>
</dl>
</li>
<li>
<a name="diagnose_mass_of_layer"></a>
<h4>diagnose_mass_of_layer</h4>
<dl>
<dt>
<b>DESCRIPTION</b>
</dt>
<dd>

 Diagnose the mass of a layer as a function of layer and (i,j). 

 Method uses linear interpolation to find the mass per area of
 layer boundaries, which are then used to get mass per area of
 layer, and then mass through multipication by area.  

 Diagnostic only makes sense when layer_level is monotonically
 increasing as go deeper in water column. 

 </dd>
<br>
<br>
</dl>
</li>
</ol>
<!-- END PUBLIC ROUTINES -->
<a name="PUBLIC TYPES"></a>
<!-- BEGIN PUBLIC TYPES -->
<!-- END PUBLIC TYPES --><a name="NAMELIST"></a>
<hr>
<h4>NAMELIST</h4>
<!-- BEGIN NAMELIST -->
<div>
<b>&amp;ocean_tracer_util_nml</b>
<br>
<br>
<div>
<dl>
<dt>
<tt>rebin_onto_rho_all_values</tt>
</dt>
<dl>
  Set true to if wish to bin all values into density classes, even 
  those cells whose density is outside the max and min range of the 
  density bins.  The default is rebin_onto_rho_all_values=.true.,
  which means those cells with extreme density values will be included. 
  This default is consistent with the default computation of 
  transport_on_nrho.  
  <br>
<span class="type">[logical]</span>
</dl>
<dt>
<tt>debug_diagnose_mass_of_layer</tt>
</dt>
<dl>
  To help debug the algorithm to diagnose mass of fluid within
  a neutral density layer. 
  Default:  debug_diagnose_mass_of_layer=.false.
  <br>
<span class="type">[logical]</span>
</dl>
<dt>
<tt>epsln_diagnose_mass_of_layer</tt>
</dt>
<dl>
  Relative mass difference allowable between layer and level total mass. 
  Default: epsln_diagnose_mass_of_layer=1e-4.
  <br>
<span class="type">[real]</span>
</dl>
</dl>
</div>
</div>
<br>
<!-- END NAMELIST -->
<a name="PUBLIC CODE"></a>
<!-- BEGIN PUBLIC CODE -->
<!-- END PUBLIC CODE -->
<hr>
<div align="right">
<font size="-1"><a href="#TOP">top</a></font>
</div>
</body>
</html>
